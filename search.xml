<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>image test</title>
    <url>/posts/2852138d/</url>
    <content><![CDATA[<p>typora图片插入格式设置 <code>![](相对文件夹/图片名)</code></p>
<img src="/posts/2852138d/test.png" class alt="image">
]]></content>
      <categories>
        <category>Hexo框架</category>
      </categories>
  </entry>
  <entry>
    <title>如何开展研究背景调研和总结？</title>
    <url>/posts/e8c71149/</url>
    <content><![CDATA[<blockquote>
<p>开场白待补充</p>
</blockquote>
<p>本文预计包含以下内容：</p>
<ol>
<li>为什么要进行文献调研和现状分析？</li>
<li>要把握的重难点是？</li>
<li>怎么查文献读文献？</li>
<li>应用类？方法类？如何总结归纳</li>
<li>论文背景部分怎么写？</li>
</ol>
<span id="more"></span>

<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote>
<p>最近一个多月的时间，由于团队在进行几个项目的申请工作，所以非常密集地针对几个较为宽泛的研究主题进行了<u>文献调研、研究现状归纳总结和撰写研究背景</u>，过程中有了很多收获，遂想花点时间静心整理一下自己入学一年多时间里在读文献，调查研究现状和写背景方面的一些习惯和心得。</p>
</blockquote>
<p>这周加班干活，具体内容待闲暇时间补充……</p>
]]></content>
      <categories>
        <category>科研</category>
      </categories>
      <tags>
        <tag>文献</tag>
      </tags>
  </entry>
  <entry>
    <title>文献篇 (2)论文下载</title>
    <url>/posts/99dce68a/</url>
    <content><![CDATA[<blockquote>
<p>分享一下自己平时下载文献的流程和几种方式…</p>
</blockquote>
<p>今天有人问我是怎么下载<strong>英文文献</strong>的？</p>
<p>我大概捋了一下：</p>
<ol>
<li>论文所在官网</li>
<li><a href="https://scholar.google.com/">谷歌学术</a> + <a href="https://sci-hub.se/">Scihub</a>（优先doi号搜索）</li>
<li><a href="https://www.researchgate.net/">researchgate</a>，若作者未发可以点击<strong>请求全文</strong></li>
<li>……</li>
</ol>
<span id="more"></span>

<h2 id="主页"><a href="#主页" class="headerlink" title="主页"></a>主页</h2><p>下载文献的目的通常是为了精度或者引用，所以我的习惯是首先应明确论文是否需要下载，这时候一般</p>
<ol>
<li>进到论文主页（通过名称或doi直接搜索直达）查看作者及摘要信息等，确定论文是否需要下载</li>
<li>确定下载后先看能不能通过主页下载，有的期刊本身是开源的或者作者选择了Open，这之后可以直接下，若不行则尝试机构登录</li>
<li>用科学院的邮箱进行机构登录可以解锁ELSEVIER及很多好期刊的资源，能通过机构下载的优先使用，这样的文章pdf质量也最好,如<a href="https://www.nature.com/articles/s41558-022-01344-2">示例1</a>，<a href="https://doi.org/10.1016/j.compenvurbsys.2022.101777">示例2</a></li>
</ol>
<img src="/posts/99dce68a/image-20220609213555174.png" class alt="image-20220609213555174">

<img src="/posts/99dce68a/image-20220609214043317.png" class alt="image-20220609214043317">

<h2 id="谷歌学术或SciHub"><a href="#谷歌学术或SciHub" class="headerlink" title="谷歌学术或SciHub"></a>谷歌学术或SciHub</h2><blockquote>
<p>(<a href="https://scholar.google.com/">Google 学术搜索</a>)<a href="https://sci-hub.se/">Sci-Hub消除科学障碍</a></p>
<p>一般前面的操作不行我才会到scihub求助</p>
</blockquote>
<img src="/posts/99dce68a/image-20220609214239964.png" class alt="image-20220609214239964">

<img src="/posts/99dce68a/image-20220609214345185.png" class alt="image-20220609214345185">

<h2 id="ResearchGate"><a href="#ResearchGate" class="headerlink" title="ResearchGate"></a>ResearchGate</h2><blockquote>
<p> <a href="https://www.researchgate.net/">https://www.researchgate.net/</a></p>
</blockquote>
<p>很多学者都会在这里建立自己的个人建立，并及时添加个分享最新的研究成果，加上平台的学者网络和研究推荐，是个很实用的<strong>学者及论文追踪平台</strong></p>
<p>这里很多人会把论文的预印本或者发表后的pdf附在成果上，如果没有则可以<strong>请求全文</strong>，基本上有求必应（有点时间长可以尝试发邮件），有人对自己的研究感兴趣，这对于科研人员来说是件非常高兴的事情，如这周我就给两名陌生学者共享了组里的未开源的论文pdf</p>
<img src="/posts/99dce68a/image-20220609214948366.png" class alt="image-20220609214948366">

<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><p>如果还不能找到自己的文献可以求助他人同学，或者给论文作者发邮件</p>
<p>以上~</p>
]]></content>
      <categories>
        <category>科研</category>
      </categories>
      <tags>
        <tag>英文论文下载</tag>
      </tags>
  </entry>
  <entry>
    <title>R语言学习1：基础</title>
    <url>/posts/7b2f7b5e/</url>
    <content><![CDATA[<blockquote>
<p><strong>从Python到R</strong>~</p>
</blockquote>
<p>相比于Python，R语言在进行统计分析建模及可视化方面有明显优势，且很多算法提供了R版本但不一定有Python。而两种语言在数据处理分析等方面其实相像，因此可以通过<strong>类比</strong>熟悉一下R语言，以便快速上手R并完成一些工作。</p>
<p>本文小结R语言基础，主要涉及</p>
<ol>
<li>基本语法，数据类型</li>
<li>常用函数，流程控制（写循环）</li>
<li>文件读写及数据框的常规操作</li>
</ol>
<span id="more"></span>

<p>目前我用Python最常用的有以下操作：</p>
<ol>
<li>用列表或字典存数据；写for循环；创建DataFrame。</li>
<li>批量获取文件名；读写csv文件，获取表格字段信息等；行列筛选；分组聚合。</li>
<li>对DataFrame进行运算，apply函数应用。</li>
</ol>
<p>R的基础语法和数据类型？在R中上述常规操作如何实现？</p>
<img src="/posts/7b2f7b5e/dataframe.png" class alt="dataframe">

<h2 id="R基础"><a href="#R基础" class="headerlink" title="R基础"></a>R基础</h2><h3 id="对象类型"><a href="#对象类型" class="headerlink" title="对象类型"></a>对象类型</h3><blockquote>
<p>R中的对象即是我们通常理解的变量</p>
<p><strong>R的索引默认从1开始而非0</strong></p>
</blockquote>
<p>数值类型：TRUE&#x2F;FLASE; integer; numric; complex; character; raw(二进制)</p>
<p>特殊：Inf(正无穷); -Inf; NaN(非数字); NA(缺失，不存在); NULL(空变量，元素存在但是没赋值)</p>
<ol>
<li>向量&#x2F;Vector，<code>c()</code>，相当于数组，其内元素的类型必须相同</li>
<li>列表&#x2F;List，<code>list()</code>，类似于Python中的list但是包容性更强，可以同时包含多种不同类型的数据</li>
<li>矩阵&#x2F;Matrix，<code>matrix()</code>,二维数组</li>
<li>数组&#x2F;Array，<code>array()</code></li>
<li>因子&#x2F;Factor，<code>factor()</code>，类别变量</li>
<li>数据框&#x2F;Data Frame，<code>data.frame()</code>，表格数据，每列为一个向量，列名为name</li>
</ol>
<h3 id="运算"><a href="#运算" class="headerlink" title="运算"></a>运算</h3><ol>
<li><p>比较：用<code>==; !=</code>来比较整数&#x2F;向量&#x2F;字符串是否相等，用<code>all.equal(a,b)</code>比较两个数字</p>
</li>
<li><p>变量赋值：<code>&lt;-; =</code>，都可以，个人习惯&#x3D;，全局变量赋值<code>&lt;&lt;-</code></p>
</li>
<li><p>逻辑向量：<code>&amp; ! |</code>，与非或，根据向量生成逻辑向量<code>any();all()</code></p>
</li>
</ol>
<h3 id="流程控制"><a href="#流程控制" class="headerlink" title="流程控制"></a>流程控制</h3><ol>
<li><code>if else</code></li>
</ol>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span><span class="punctuation">(</span>x<span class="operator">&gt;</span><span class="number">3</span><span class="punctuation">)</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    y<span class="operator">=</span><span class="number">6</span></span><br><span class="line"><span class="punctuation">&#125;</span> <span class="keyword">else</span></span><br><span class="line"><span class="punctuation">&#123;</span>message<span class="punctuation">(</span><span class="string">&quot;ok&quot;</span><span class="punctuation">)</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ol start="2">
<li><code>repeat</code>循环，结合<code>next; break</code></li>
</ol>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">n<span class="operator">=</span><span class="number">0</span>;j<span class="operator">=</span><span class="number">0</span></span><br><span class="line">message<span class="punctuation">(</span><span class="string">&quot;do while&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="keyword">repeat</span><span class="punctuation">&#123;</span></span><br><span class="line">  n<span class="operator">=</span>n<span class="operator">+</span><span class="number">1</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span>n<span class="operator">%%</span><span class="number">7</span><span class="operator">==</span><span class="number">0</span><span class="punctuation">)</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">    message<span class="punctuation">(</span>n<span class="punctuation">)</span></span><br><span class="line">    <span class="keyword">next</span>  <span class="comment">#跳过后续代码直接进入下一次迭代</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line">  j<span class="operator">=</span>j<span class="operator">+</span><span class="number">1</span></span><br><span class="line">  <span class="keyword">if</span><span class="punctuation">(</span>n<span class="operator">==</span><span class="number">100</span><span class="punctuation">)</span> <span class="keyword">break</span> <span class="comment">#结束循环</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br><span class="line"><span class="comment"># j=86，跳过了14次</span></span><br></pre></td></tr></table></figure>

<ol start="3">
<li><code>while</code>循环，直接用</li>
<li><code>for</code>循环</li>
</ol>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span><span class="punctuation">(</span>i <span class="keyword">in</span> <span class="number">1</span><span class="operator">:</span><span class="number">5</span><span class="punctuation">)</span><span class="punctuation">&#123;</span><span class="punctuation">&#125;</span> </span><br><span class="line"><span class="keyword">for</span><span class="punctuation">(</span>n <span class="keyword">in</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="literal">TRUE</span><span class="punctuation">,</span> <span class="literal">FALSE</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">&#123;</span><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="常用函数"><a href="#常用函数" class="headerlink" title="常用函数"></a>常用函数</h2><h3 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h3><p><code>library(bfast)</code>: 导入三方包，此处为bfast</p>
<p><code>Rscript test.R </code>：运行脚本</p>
<p><code>ls()</code>：查看所有变量，ls(pattern&#x3D;“ab”)可以正则匹配</p>
<p><code>rm(list=ls())</code>：删除所有变量</p>
<p><code>class(); mode(); typeof()</code>:查看变量&#x2F;数值类型：</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">x <span class="operator">=</span> array<span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">24</span><span class="punctuation">,</span> <span class="built_in">dim</span><span class="operator">=</span><span class="built_in">c</span><span class="punctuation">(</span><span class="number">4</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">class</span><span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="comment">#&quot;array&quot;</span></span><br><span class="line">mode<span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="comment">#&quot;numeric&quot;</span></span><br><span class="line">typeof<span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="comment">#&quot;integer&quot;</span></span><br></pre></td></tr></table></figure>

<p><code>length()</code>：计算向量长度</p>
<p><code>dim()</code>：返回多维向量的维度</p>
<p><code>names()</code>：对象命名, R中可以给每个对象赋予名称，类似于字典的<strong>键</strong></p>
<p><code>unlist()</code>；将多维list展开成一维</p>
<p><code>options(digits=n)</code>：设置全局小数点显示位数</p>
<p><code>summary()</code>:汇总函数，输出向量最大最小值四分位数等信息，也可以作用与data.frame，每列的汇总信息</p>
<p><code>attribute/</code>查看对象的所有属性裂变</p>
<p><code>View()</code>以电子表格的形式查看data.frame</p>
<h3 id="路径"><a href="#路径" class="headerlink" title="路径"></a>路径</h3><blockquote>
<p>R中支持正斜杠<code>/</code>或双反斜杠<code>\\</code></p>
</blockquote>
<p><code>path = getwd()</code>：返回当前工作路径</p>
<p><code>file.path(&quot;c&quot;,&quot;program files&quot;,&quot;R&quot;)</code>:拼接，类似于Python中的os.path.join()</p>
<p><code>files = dir(path ,pattern = &quot;\\.csv$&quot;)</code>：返回路径下所有csv文件</p>
<p><code>basename(file)</code>：文件名</p>
<p><code>path.expand(&quot;~&quot;)</code>：返回当前绝对”C:&#x2F;Users&#x2F;huangs&#x2F;Documents”</p>
<h3 id="”字典name”"><a href="#”字典name”" class="headerlink" title="”字典name”"></a>”字典name”</h3><figure class="highlight r"><table><tr><td class="code"><pre><span class="line">x <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span><span class="punctuation">(</span>x<span class="punctuation">)</span> <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;a1&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;a2&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;a3&#x27;</span><span class="punctuation">,</span><span class="string">&#x27;a4&#x27;</span><span class="punctuation">)</span></span><br><span class="line">x<span class="punctuation">[</span><span class="string">&#x27;a1&#x27;</span><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<h3 id="创建序列”range”"><a href="#创建序列”range”" class="headerlink" title="创建序列”range”"></a>创建序列”range”</h3><p><code>1:10</code>：创建一个1~10的序列</p>
<p><code>seq(); seq.int()</code>：相当于Python中的range()</p>
<p><code>seq_alone(x)</code>：创建一个和x一样长的，从1开始的序列</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">seq<span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span> <span class="number">1</span><span class="punctuation">,</span> length.out <span class="operator">=</span> <span class="number">11</span><span class="punctuation">)</span> <span class="comment"># 0.1~1.0</span></span><br><span class="line"><span class="built_in">seq.int</span><span class="punctuation">(</span><span class="number">0</span><span class="punctuation">,</span><span class="number">10</span><span class="punctuation">)</span> <span class="comment">#0 1 ... 10</span></span><br><span class="line">seq<span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span> <span class="number">9</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="number">2</span><span class="punctuation">)</span>     <span class="comment"># 1 3 5 7 9</span></span><br><span class="line">seq<span class="punctuation">(</span><span class="number">1.575</span><span class="punctuation">,</span> <span class="number">5.125</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="number">0.05</span><span class="punctuation">)</span></span><br><span class="line">seq<span class="punctuation">(</span><span class="number">17</span><span class="punctuation">)</span> <span class="comment">#等价于seq.int(17) seq(1:17) seq_len(17)</span></span><br></pre></td></tr></table></figure>

<p><code>rep(1:5),3</code>：基于一个序列的重复构造新序列，有多个参数可选，可以自定义重复规则</p>
<p><code>runif(30，1, 50)</code>：服从标准&#x2F;随机分布的30个数，random uniform seq</p>
<h3 id="创建时间序列"><a href="#创建时间序列" class="headerlink" title="创建时间序列"></a>创建时间序列</h3><blockquote>
<p>有关R中的时间在另外的笔记中进行总结</p>
</blockquote>
<p>seq.Date: Generate Regular Sequences of Dates。<a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/seq.Date">api</a></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">## first days of years</span></span><br><span class="line">seq<span class="punctuation">(</span>as.Date<span class="punctuation">(</span><span class="string">&quot;1910/1/1&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> as.Date<span class="punctuation">(</span><span class="string">&quot;1999/1/1&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&quot;years&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">## by month</span></span><br><span class="line">seq<span class="punctuation">(</span>as.Date<span class="punctuation">(</span><span class="string">&quot;2000/1/1&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;month&quot;</span><span class="punctuation">,</span> length.out <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">## quarters</span></span><br><span class="line">seq<span class="punctuation">(</span>as.Date<span class="punctuation">(</span><span class="string">&quot;2000/1/1&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> as.Date<span class="punctuation">(</span><span class="string">&quot;2003/1/1&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;quarter&quot;</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## find all 7th of the month between two dates, the last being a 7th.</span></span><br><span class="line">st <span class="operator">&lt;-</span> as.Date<span class="punctuation">(</span><span class="string">&quot;1998-12-17&quot;</span><span class="punctuation">)</span></span><br><span class="line">en <span class="operator">&lt;-</span> as.Date<span class="punctuation">(</span><span class="string">&quot;2000-1-7&quot;</span><span class="punctuation">)</span></span><br><span class="line">ll <span class="operator">&lt;-</span> seq<span class="punctuation">(</span>en<span class="punctuation">,</span> st<span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;-1 month&quot;</span><span class="punctuation">)</span></span><br><span class="line">rev<span class="punctuation">(</span>ll<span class="punctuation">[</span>ll <span class="operator">&gt;</span> st <span class="operator">&amp;</span> ll <span class="operator">&lt;</span> en<span class="punctuation">]</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<p>seq.POSIXt: Generate Regular Sequences of Times。<a href="https://www.rdocumentation.org/packages/base/versions/3.6.2/topics/seq.POSIXt">api</a></p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment">## first days of years</span></span><br><span class="line">seq<span class="punctuation">(</span>ISOdate<span class="punctuation">(</span><span class="number">1910</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> ISOdate<span class="punctuation">(</span><span class="number">1999</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> <span class="string">&quot;years&quot;</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">## by month</span></span><br><span class="line">seq<span class="punctuation">(</span>ISOdate<span class="punctuation">(</span><span class="number">2000</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;month&quot;</span><span class="punctuation">,</span> length.out <span class="operator">=</span> <span class="number">12</span><span class="punctuation">)</span></span><br><span class="line">seq<span class="punctuation">(</span>ISOdate<span class="punctuation">(</span><span class="number">2000</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">31</span><span class="punctuation">)</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;month&quot;</span><span class="punctuation">,</span> length.out <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br><span class="line"><span class="comment">## quarters</span></span><br><span class="line">seq<span class="punctuation">(</span>ISOdate<span class="punctuation">(</span><span class="number">1990</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> ISOdate<span class="punctuation">(</span><span class="number">2000</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">,</span><span class="number">1</span><span class="punctuation">)</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;quarter&quot;</span><span class="punctuation">)</span> <span class="comment"># or &quot;3 months&quot;</span></span><br><span class="line"><span class="comment">## days vs DSTdays: use c() to lose the time zone.</span></span><br><span class="line">seq<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span>ISOdate<span class="punctuation">(</span><span class="number">2000</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;day&quot;</span><span class="punctuation">,</span> length.out <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">seq<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span>ISOdate<span class="punctuation">(</span><span class="number">2000</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;DSTday&quot;</span><span class="punctuation">,</span> length.out <span class="operator">=</span> <span class="number">10</span><span class="punctuation">)</span></span><br><span class="line">seq<span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span>ISOdate<span class="punctuation">(</span><span class="number">2000</span><span class="punctuation">,</span><span class="number">3</span><span class="punctuation">,</span><span class="number">20</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> by <span class="operator">=</span> <span class="string">&quot;7 DSTdays&quot;</span><span class="punctuation">,</span> length.out <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<h3 id="apply运算"><a href="#apply运算" class="headerlink" title="apply运算"></a>apply运算</h3><ul>
<li><p><code>lapply(list(),f(x))</code>：<code>&quot;list apply&quot;</code>，</p>
<ul>
<li>对<strong>list</strong>中的每一个元素依次计算<code>f()</code>，并返回一个新的<strong>list</strong></li>
</ul>
</li>
<li><p><code>vapply(list()/vector(), f(x), numeric(1))</code>：<code>&quot;vaetor apply&quot;</code>：返回vector，但需要确保结果可用vector包装并指定返回的数据类型及长度</p>
</li>
<li><p><code>eapply()</code>；遍历环境中的变量</p>
</li>
<li><p><code>mapply()</code>:多参数apply，</p>
</li>
<li><p><code>tapply</code>：类似<strong>group by</strong>，<code>with(data, tapply(x1, x2, f()))</code></p>
<ul>
<li><code>by, aggregate</code></li>
</ul>
</li>
<li><p><code>library(plyr)</code>：指定输入输出形式的apply函数</p>
<ul>
<li><code>ddply()</code>; 输入输出为<strong>data.frame</strong></li>
<li><code>llply()</code>；输入输出均为list</li>
<li><code>laply()</code>；输入list，输出array</li>
</ul>
</li>
</ul>
<h3 id="CSV读写"><a href="#CSV读写" class="headerlink" title="CSV读写"></a>CSV读写</h3><ul>
<li><p>数据加载：<code>load(file = &quot;...rda&quot;)</code></p>
</li>
<li><p>csv读写：</p>
</li>
</ul>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">df <span class="operator">=</span> read.csv<span class="punctuation">(</span>path<span class="punctuation">,</span> header <span class="operator">=</span> <span class="literal">TRUE</span><span class="punctuation">,</span>encoding <span class="operator">=</span> <span class="string">&quot;UTF-8&quot;</span><span class="punctuation">)</span></span><br><span class="line">write.csv<span class="punctuation">(</span>df<span class="punctuation">,</span>file <span class="operator">=</span> <span class="string">&#x27;....csv&#x27;</span><span class="punctuation">,</span>row.names <span class="operator">=</span> <span class="built_in">F</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<h2 id="表格操作"><a href="#表格操作" class="headerlink" title="表格操作"></a>表格操作</h2><blockquote>
<p>R中的data.frame类似于Python的pandas dataframe ，用于表示表格型数据，应用十分灵活方便</p>
</blockquote>
<h3 id="行列选择"><a href="#行列选择" class="headerlink" title="行列选择"></a>行列选择</h3><figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 创建</span></span><br><span class="line">data.frame<span class="punctuation">(</span></span><br><span class="line">x <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>..<span class="punctuation">)</span></span><br><span class="line">y <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>..<span class="punctuation">)</span></span><br><span class="line">z <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>..<span class="punctuation">)</span></span><br><span class="line"><span class="built_in">names</span> <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&#x27;ID&#x27;</span><span class="punctuation">,</span>...<span class="punctuation">)</span></span><br><span class="line">row.names <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">1</span><span class="punctuation">,</span><span class="number">2</span><span class="punctuation">,</span>...<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>



<p>其他操作</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 获取表格信息</span></span><br><span class="line">str<span class="punctuation">(</span>df<span class="punctuation">)</span></span><br><span class="line">summary<span class="punctuation">(</span>df<span class="punctuation">)</span></span><br><span class="line"><span class="comment">#转置</span></span><br><span class="line">t<span class="punctuation">(</span>df<span class="punctuation">)</span> </span><br><span class="line">colSums<span class="punctuation">(</span>df<span class="punctuation">[</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">)</span><span class="operator">/</span>colMeans<span class="punctuation">(</span>df<span class="punctuation">[</span><span class="punctuation">,</span><span class="punctuation">]</span><span class="punctuation">)</span> <span class="comment">#计算列的和及均值</span></span><br><span class="line"><span class="comment"># 增加新列</span></span><br><span class="line">df<span class="operator">$</span>new_col <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span>..<span class="punctuation">)</span></span><br><span class="line"><span class="comment"># 增加新行，拼接两个df</span></span><br><span class="line">newdf <span class="operator">=</span> rbind<span class="punctuation">(</span>df1<span class="punctuation">,</span> df2<span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

<h3 id="拆分"><a href="#拆分" class="headerlink" title="拆分"></a>拆分</h3><p><code>groups = split(df, df$Quarter)</code>：返回的是<strong>dflist</strong>，通过索引访问，如<strong>groups[1]</strong></p>
<p>拆分后遍历</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">df &lt;- data.frame(</span><br><span class="line">  Weekday = factor(rep(c(&quot;Mon&quot;, &quot;Tues&quot;, &quot;Wed&quot;, &quot;Thurs&quot;, &quot;Fri&quot;), each = 4), </span><br><span class="line">                   levels = c(&quot;Mon&quot;, &quot;Tues&quot;, &quot;Wed&quot;, &quot;Thurs&quot;, &quot;Fri&quot;)),</span><br><span class="line">  Quarter = paste0(&quot;Q&quot;, rep(1:4, each = 5)), </span><br><span class="line">  Delay = c(9.9, 5.4, 8.8, 6.9, 4.9, 9.7, 7.9, 5, 8.8, 11.1, 10.2, 9.3, 12.2,</span><br><span class="line">            10.2, 9.2, 9.7, 12.2, 8.1, 7.9, 5.6))</span><br><span class="line">            </span><br><span class="line">gs = split(df, df$Quarter)</span><br><span class="line">for(gp in gs)</span><br><span class="line">&#123;</span><br><span class="line">  tempdf = data.frame(gp)</span><br><span class="line">  print(tempdf$Weekday)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="dplyr包"><a href="#dplyr包" class="headerlink" title="dplyr包"></a>dplyr包</h2><blockquote>
<p>一个功能强大的数据处理包<a href="https://dplyr.tidyverse.org/">dplyr</a></p>
</blockquote>
<p>安装：<code>install.packages(&quot;tidyverse&quot;)</code>;<code>install.packages(&quot;dplyr&quot;)</code></p>
<p><code>%&gt;%</code>管道操作符，该符号的意思是将前者作为后者的输入参数进行传入</p>
<h3 id="拆分group-split"><a href="#拆分group-split" class="headerlink" title="拆分group_split"></a>拆分group_split</h3><h3 id="Groupby分类汇总"><a href="#Groupby分类汇总" class="headerlink" title="Groupby分类汇总"></a>Groupby分类汇总</h3><p>参考<a href="https://mgimond.github.io/ES218/Week03ab_groupby.html#Count_the_number_of_records_in_each_group">1</a></p>
<p>操作实例</p>
<figure class="highlight r"><table><tr><td class="code"><pre><span class="line">df <span class="operator">&lt;-</span> data.frame<span class="punctuation">(</span></span><br><span class="line">  Weekday <span class="operator">=</span> factor<span class="punctuation">(</span><span class="built_in">rep</span><span class="punctuation">(</span><span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Mon&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Tues&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Wed&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Thurs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Fri&quot;</span><span class="punctuation">)</span><span class="punctuation">,</span> each <span class="operator">=</span> <span class="number">4</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">                   levels <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="string">&quot;Mon&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Tues&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Wed&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Thurs&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Fri&quot;</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span></span><br><span class="line">  Quarter <span class="operator">=</span> paste0<span class="punctuation">(</span><span class="string">&quot;Q&quot;</span><span class="punctuation">,</span> <span class="built_in">rep</span><span class="punctuation">(</span><span class="number">1</span><span class="operator">:</span><span class="number">4</span><span class="punctuation">,</span> each <span class="operator">=</span> <span class="number">5</span><span class="punctuation">)</span><span class="punctuation">)</span><span class="punctuation">,</span> </span><br><span class="line">  Delay <span class="operator">=</span> <span class="built_in">c</span><span class="punctuation">(</span><span class="number">9.9</span><span class="punctuation">,</span> <span class="number">5.4</span><span class="punctuation">,</span> <span class="number">8.8</span><span class="punctuation">,</span> <span class="number">6.9</span><span class="punctuation">,</span> <span class="number">4.9</span><span class="punctuation">,</span> <span class="number">9.7</span><span class="punctuation">,</span> <span class="number">7.9</span><span class="punctuation">,</span> <span class="number">5</span><span class="punctuation">,</span> <span class="number">8.8</span><span class="punctuation">,</span> <span class="number">11.1</span><span class="punctuation">,</span> <span class="number">10.2</span><span class="punctuation">,</span> <span class="number">9.3</span><span class="punctuation">,</span> <span class="number">12.2</span><span class="punctuation">,</span></span><br><span class="line">            <span class="number">10.2</span><span class="punctuation">,</span> <span class="number">9.2</span><span class="punctuation">,</span> <span class="number">9.7</span><span class="punctuation">,</span> <span class="number">12.2</span><span class="punctuation">,</span> <span class="number">8.1</span><span class="punctuation">,</span> <span class="number">7.9</span><span class="punctuation">,</span> <span class="number">5.6</span><span class="punctuation">)</span><span class="punctuation">)</span></span><br><span class="line"></span><br><span class="line">library<span class="punctuation">(</span>dplyr<span class="punctuation">)</span></span><br><span class="line">df <span class="operator">%&gt;%</span> </span><br><span class="line">  group_by<span class="punctuation">(</span>Weekday<span class="punctuation">)</span> <span class="operator">%&gt;%</span> </span><br><span class="line">  summarize<span class="punctuation">(</span>min_delay <span class="operator">=</span> <span class="built_in">min</span><span class="punctuation">(</span>Delay<span class="punctuation">)</span><span class="punctuation">,</span> max_delay <span class="operator">=</span> <span class="built_in">max</span><span class="punctuation">(</span>Delay<span class="punctuation">)</span><span class="punctuation">)</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>R语言</category>
      </categories>
      <tags>
        <tag>R语言</tag>
        <tag>入门教程</tag>
      </tags>
  </entry>
  <entry>
    <title>Hello World</title>
    <url>/posts/4a17b156/</url>
    <content><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p>
<span id="more"></span>

<h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p>
<h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p>
<h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p>
<h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure>

<p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>
<h3 id="command"><a href="#command" class="headerlink" title="command"></a>command</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo deploy</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Hexo框架</category>
      </categories>
      <tags>
        <tag>hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>浅析Python中的类、模块、包</title>
    <url>/posts/659ef075/</url>
    <content><![CDATA[<p>类和继承是面向对象编程<a href="https://en.wikipedia.org/wiki/Object-oriented_programming">(OOP)</a>中的重要概念，Python中的大量模块等也都是基于类实现的；模块和包是Python可拓展性和便捷性的支撑，也是我们接触最多的内容。了解Python中的类、模块和包一方面有助于强化写代码时候的<strong>逻辑</strong>（更清楚地知道自己写的代码-每一步是在干嘛）、提高效率，同时便于我们更好地<strong>读懂</strong>并复制粘贴别人的代码。本文主要内容：</p>
<ol>
<li>Python中的<strong>模块(module)<strong>和</strong>包(package)</strong></li>
<li>Python中如何定义<strong>类(class)</strong></li>
<li>什么时候需要类？</li>
</ol>
<span id="more"></span>

<h2 id="模块和包"><a href="#模块和包" class="headerlink" title="模块和包"></a>模块和包</h2><blockquote>
<p><a href="https://docs.python.org/3/tutorial/modules.html">官方文档的介绍——Modules in python</a></p>
</blockquote>
<p><strong>模块</strong>：一个**.py文件**就构成了一个模块，模块名即为去掉后缀之后的名。</p>
<p><strong>包</strong>：一个包含<code>__init__.py</code>文件+若干子包+若干模块的<strong>文件夹</strong>，文件夹的名字即为<strong>包名</strong>，第一个文件是必须（该文件的作用即是为了防止系统将含.py文件的文件夹均识别为包）。</p>
<ul>
<li>模块包含内置模块、标准模块以及第三方模块；包也包括内置的包、第三方包</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 在交互窗口中运行，内置的模块路径在c拓展内</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">import</span> time,os,datetime,pandas</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>time</span><br><span class="line">&lt;module <span class="string">&#x27;time&#x27;</span> (built-<span class="keyword">in</span>)&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>os</span><br><span class="line">&lt;module <span class="string">&#x27;os&#x27;</span> <span class="keyword">from</span> <span class="string">&#x27;D:\\Miniconda3\\lib\\os.py&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>datetime</span><br><span class="line">&lt;module <span class="string">&#x27;datetime&#x27;</span> <span class="keyword">from</span> <span class="string">&#x27;D:\\Miniconda3\\lib\\datetime.py&#x27;</span>&gt;</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>pandas</span><br><span class="line">&lt;module <span class="string">&#x27;pandas&#x27;</span> <span class="keyword">from</span> <span class="string">&#x27;D:\\Miniconda3\\lib\\site-packages\\pandas\\__init__.py&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>



<ul>
<li>从<a href="https://www.python.org/downloads/source/">官网</a>下载初始Python的源码做一个简单的了解：</li>
</ul>
<img src="/posts/659ef075/image-20220518132724603.png" class alt="libs">

<p>下载完成后进入文件夹：<u>A:\Python-3.10.4\Lib</u>，可以看到其中只有两种文件</p>
<ol>
<li><strong>文件夹即包。</strong>熟悉的如：json、logging、multiprocessing、urllib</li>
<li><strong>py文件，即脚本&#x2F;模块。</strong>熟悉的如：os.py、re.py、zipfile.py</li>
<li>一个<strong>特殊的空文件夹，site-packages</strong>，打开其中有一个文本描述，写的是：本目录用于存放第三方的包（通过pypi&#x2F;conda安装的包即存放在这）</li>
</ol>
<p>所以，即便我们不安装额外的包，也可以使用内置的模块及标准库中的模块与包：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> time, os, re</span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> pool</span><br></pre></td></tr></table></figure>



<p>Python的巨大优势就在于可拓展性和便捷，有大量的第三方包可供使用。另外，除了安装第三方包、我们也可以自己写模块和包用于调用。</p>
<p><u>tip：自己写的py文件放在目录下可以直接import，然后使用其中的<strong>变量及函数</strong>。通常该文件写完需要调试，这时候可以将运行的代码放在</u><code>if &#39;__main__&#39;== __main__:</code> <u>之下，这样在其他脚本import调用该”模块时”也不会执行运行的代码。</u></p>
<h2 id="定义类"><a href="#定义类" class="headerlink" title="定义类"></a>定义类</h2><p>构造函数：</p>
<h2 id="何时需要类？"><a href="#何时需要类？" class="headerlink" title="何时需要类？"></a>何时需要类？</h2><blockquote>
<p>参考：<a href="https://stackoverflow.com/questions/33072570/when-should-i-be-using-classes-in-python">使用类的原因-讨论</a></p>
</blockquote>
<blockquote>
<p>通常，使用Python的内置及第三方模块可以完成我们的工作，并不需要自定义类，但随着工作量的增大和复杂化，或许会有这样的需求，以pandas为例</p>
</blockquote>
<p>结合实际讨论，</p>
<ol>
<li>当我们通过<code>pandas.read_csv()</code>读取一个文件之后，得到一个实例化的对象<code>dataframe</code>，接下来我们可以通过columns,names,head,shape等参数访问其属性，即对象实例化之后我们可以使用和追踪它的状态，就好像创建了一个list，而不只是调用了一个方法。</li>
<li>便于拓展和重用，可以继承，即方便别人用和自己调用，比如他人可以基于pandas开发geopandas等包，也即是依赖</li>
<li>结构清晰，好看，从各种包的api文档（如<a href="https://pandas.pydata.org/pandas-docs/stable/reference/frame.html">pandas</a>，<a href="https://matplotlib.org/stable/gallery/index.html">matplotlib</a>，<a href="https://numpy.org/doc/stable/reference/index.html">numpy</a>，<a href="https://geopandas.org/en/latest/docs/reference.html">geopandas</a>……）我们可以看看，其组织结构清楚，便于查阅……</li>
<li>……</li>
</ol>
<p><strong>何时使用？</strong>——拙见</p>
<p>（虽然在享受着类的便捷，但个人还没遇到一定得用类的情况hh）</p>
<ul>
<li>当工作简单或者只是实现一个或者多个函数时，不需要。类的重要一点就是属性和方法组装在了一起，如果只是一个一次性的处理脚本不需要类</li>
<li>编写开源包和模块时</li>
<li>工作量比较大，代码组织感觉比较乱时，可以考虑（但其实理理逻辑，通过多个脚本也可以写出结构清晰的脚本）。</li>
<li></li>
</ul>
]]></content>
      <categories>
        <category>Python基础</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>类</tag>
        <tag>模块</tag>
      </tags>
  </entry>
  <entry>
    <title>诗文共读： When I started loving myself</title>
    <url>/posts/29d41ed/</url>
    <content><![CDATA[<p>今天是2022年5月20日，加了一天的班赶材料，这会闲下来，贴一首诗……</p>
<span id="more"></span>

<h2 id="When-I-started-loving-myself"><a href="#When-I-started-loving-myself" class="headerlink" title="When I started loving myself"></a>When I started loving myself</h2><h2 id="当我开始爱自己"><a href="#当我开始爱自己" class="headerlink" title="当我开始爱自己"></a>当我开始爱自己</h2><blockquote>
<p>The poem below was written by Charlie Chaplin on his 70th birthday,  April 16, 1959. <a href="https://charterforcompassion.org/attributes-of-compassion/when-i-started-loving-myself">参考</a></p>
</blockquote>
<p>When I started loving myself<br>I understood that I’m always and at any given opportunity<br>in the right place at the right time.<br>And I understood that all that happens is right –<br>from then on I could be calm.<br>Today I know: It’s called TRUST.</p>
<p>When I started to love myself I understood how much it can offend somebody<br>When I tried to force my desires on this person,<br>even though I knew the time is not right and the person was not ready for it,<br>and even though this person was me.<br>Today I know: It’s called LETTING GO</p>
<p>When I started loving myself<br>I could recognize that emotional pain and grief<br>are just warnings for me to not live against my own truth.<br>Today I know: It’s called AUTHENTICALLY BEING.</p>
<p>When I started loving myself<br>I stopped longing for another life<br>and could see that everything around me was a request to grow.<br>Today I know: It’s called MATURITY.</p>
<p>When I started loving myself<br>I stopped depriving myself of my free time<br>and stopped sketching further magnificent projects for the future.<br>Today I only do what’s fun and joy for me,<br>what I love and what makes my heart laugh,<br>in my own way and in my tempo.<br>Today I know: it’s called HONESTY.</p>
<p>When I started loving myself<br>I escaped from all what wasn’t healthy for me,<br>from dishes, people, things, situations<br>and from everything pulling me down and away from myself.<br>In the beginning I called it the “healthy egoism”,<br>but today I know: it’s called SELF-LOVE.</p>
<p>When I started loving myself<br>I stopped wanting to be always right<br>thus I’ve been less wrong.<br>Today I’ve recognized: it’s called HUMBLENESS.</p>
<p>When I started loving myself<br>I refused to live further in the past<br>and worry about my future.<br>Now I live only at this moment where EVERYTHING takes place,<br>like this I live every day and I call it CONSCIOUSNESS.</p>
<p>When I started loving myself<br>I recognized, that my thinking<br>can make me miserable and sick.<br>When I requested for my heart forces,<br>my mind got an important partner.<br>Today I call this connection HEART WISDOM.</p>
<p>We do not need to fear further discussions,<br>conflicts and problems with ourselves and others<br>since even stars sometimes bang on each other<br>and create new worlds.<br>Today I know: THIS IS LIFE!</p>
<h2 id="爱"><a href="#爱" class="headerlink" title="爱"></a>爱</h2><blockquote>
<p>韶华易逝，好好珍惜</p>
</blockquote>
<p>人这一生</p>
<ul>
<li>向内，追寻精神的成长，自我的独立和完善、灵魂的完整<ul>
<li>勇敢而坚定地去认识、接纳和锻炼自己吧……</li>
</ul>
</li>
<li>向外<ul>
<li>寻一个钟爱的人、一份热爱的事业，勇敢地、精心地守护和前行</li>
<li>和谐共处的家庭、社会关系和社会生活……</li>
</ul>
</li>
</ul>
<p>我们始终是自由的，不要因为他人言语和外界环境而妥协扭曲自己心底的渴望和热爱，喜欢的话就勇敢地去追逐吧，一步一步……</p>
]]></content>
      <categories>
        <category>生活</category>
      </categories>
  </entry>
  <entry>
    <title>matplotlib绘图基础1：图的组成元素</title>
    <url>/posts/8dfff56a/</url>
    <content><![CDATA[<p>一张好看的学术图表不仅能够更优雅简洁地传递信息，也能给人予美的享受。在撰写学术论文的过程，耗费大量时间的除了做实验，另一个一定是作图了，要通过几张图把信息很好地呈现出来，需要费不少功夫。</p>
<p><strong>绘图技能</strong>是我一直想要拓展和延伸的一个技能。这一方面需要通过大量的输入来学习别人对图表的设计和呈现，学习色彩、布局等等……另一方面还要能够用代码来实现，而需要基于代码的可视化是一个比较繁琐的内容，需要学习和积累。故在此开始记录自己Python可视化的学习过程，当然，也便于代码的复用。</p>
<blockquote>
<p>本系列博客主要参考：<a href="https://matplotlib.org/stable/api/index.html">Matplotlib文档</a>，<a href="https://matplotlib.org/stable/gallery/index.html">Matplotlib Gallery</a>，部分参考<a href="https://github.com/rougier/scientific-visualization-book">Rougier老师的开源书</a></p>
</blockquote>
<p>本文主要涉及内容：</p>
<ol>
<li><strong>Matplotlib中Figure的组成要素</strong></li>
<li><strong>主要元素的常用方法汇总</strong></li>
<li>其他的诸如风格、字体、网格、图例、色带陆续总结……</li>
</ol>
<span id="more"></span>

<p>另外，快速绘图<a href="https://matplotlib.org/cheatsheets/cheatsheets.pdf">备忘录下载</a>，该备忘录有两张大图（<a href="https://camo.githubusercontent.com/bc3b143766ed68eb6a851900c317c5d9222eb1471888942afb35137aa5141557/68747470733a2f2f6d6174706c6f746c69622e6f72672f63686561747368656574732f63686561747368656574732d312e706e67">基础绘图</a>;<a href="https://camo.githubusercontent.com/8566d191963c2ada58246241d19a1252c519edea1ecf4049f5bc939e302e36a8/68747470733a2f2f6d6174706c6f746c69622e6f72672f63686561747368656574732f63686561747368656574732d322e706e67">色彩及文字等</a>），可以快速查看常见的绘图操作&#x2F;函数，函数右侧的<strong>api</strong>还可以点击直达官网api文档详细介绍。</p>
<img src="/posts/8dfff56a/text-shadow.png" class alt="matplotlib">

<p>上图通过matplotlib代码制作，详见<a href="https://github.com/rougier/scientific-visualization-book">book</a></p>
<h2 id="图的组成"><a href="#图的组成" class="headerlink" title="图的组成"></a>图的组成</h2><blockquote>
<p>matplotlib最新版的文档做了较大的改版，提供了更全的<a href="https://matplotlib.org/stable/gallery/index.html">api参考</a></p>
</blockquote>
<p>下图是Matplotlib官方文档中提供的一张介绍图组成元素的图，很整洁，左图为<a href="https://matplotlib.org/3.1.1/gallery/showcase/anatomy.html">旧版anatomy</a>，右图为最新的文档<a href="https://matplotlib.org/stable/gallery/showcase/anatomy.html?highlight=anatomy">anatomy</a>里的图，我稍作改动放到了一起：</p>
<img src="/posts/8dfff56a/anatomy.png" class alt="anatomy">

<h3 id="组成总览"><a href="#组成总览" class="headerlink" title="组成总览"></a>组成总览</h3><ul>
<li><p><strong>Figure</strong>：所有绘图元素的顶级容器，大致可以理解为<strong>画布canvas</strong>。我们可以设置它的尺寸(figsize)、标题(suptile)、背景颜色(facecolor )等属性，背景默认是透明 transparent&#x3D;True。</p>
</li>
<li><p><strong>Axes</strong>：相当于Subplot，子图，是我们实际的绘图区域，为<strong>矩形</strong>。一张图可以有多个子图(Axes)，如上图</p>
<ul>
<li><strong>Spines</strong>： 图边，每个子图都有4条边，<u>每条边有主副刻度线(Tick)+主副刻度标签(Tick labels)+边标签(Label)</u>，默认只显示左+下的Spine。</li>
<li><strong>Axis</strong>：默认显示的左和下方的两条Spines分别为<u>yaxis，xaxis</u>，属性同Spines。</li>
<li><strong>Line points</strong>…：绘制的图形，也就是我们要在axes上画的东西</li>
<li><strong>Legend</strong>：图例，每个axes都可以根据其上绘制的图形生成图例，也可以不依赖图形单独创建。</li>
<li><strong>Grid</strong>：网格线，自行选择是否添加（按照主副刻度线生成）</li>
<li><strong>Text：</strong>文本，可以作为注释说明添加到图上<ul>
<li><strong>Annotation</strong>：可以添加连接线&#x2F;箭头的文本，注释</li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Artist</strong> : <strong>Everything on the figure</strong>, including Figure, Axes, and Axis objects, is an artist. 理解为图元素。</p>
<ul>
<li>组成<a href="https://matplotlib.org/stable/_images/inheritance-746d7ad5b4a3ecbadc51ab040f5d995f5c6ecc71.png">图</a></li>
</ul>
</li>
</ul>
<p>了解了组成部件，之后我们的学习任务主要就是了解和属性各个部件繁多的<strong>属性和属性调整的方法</strong>，以及组合。</p>
<p>下一节即有针对性地看一下各个元素的属性方法等</p>
<h3 id="图的基本单元"><a href="#图的基本单元" class="headerlink" title="图的基本单元"></a>图的基本单元</h3><p>任意的一张图，本质上是由以下三种要素的组合（莫明想起了GIS里的点线面hh）：</p>
<ul>
<li>patchs：块，如background bars ……</li>
<li>lines：线，如tick,line……</li>
<li>texts：文本，如label title……</li>
</ul>
<p>多数情况下我们都是使用绘图自带的<strong>默认</strong>设置，但是实际上，一张图的<strong>任一组成部分即上述部件都能够被访问和调整！</strong>如我们可以像下面这样直接设置每个label加粗，<strong>这些方法都能够在文档中快速找到</strong>：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">fig, ax = plt.subplots(figsize=(<span class="number">5</span>,<span class="number">2</span>))</span><br><span class="line"><span class="keyword">for</span> label <span class="keyword">in</span> ax.get_xaxis().get_ticklabels():</span><br><span class="line">    label.set_fontweight(<span class="string">&quot;bold&quot;</span>)</span><br><span class="line">    plt.show()</span><br></pre></td></tr></table></figure>

<p>🔥想强调的是，每个部件在我们创建了一个图形之后就有了<strong>类</strong>对应的<strong>实例</strong>（对类不熟悉的可以移步<a href="https://hscyber.github.io/posts/659ef075/">Python中的类</a>），通过查阅<a href="https://matplotlib.org/stable/api/index.html">文档</a>我们可以看到该对象的<strong>所有属性及方法</strong>，进一步地我们可以按需检索并实现我们对图形想要进行的<strong>任意设置或调整</strong>，下面开始介绍并举例：</p>
<h2 id="主要部件详解"><a href="#主要部件详解" class="headerlink" title="主要部件详解"></a>主要部件详解</h2><p>虽然有文档，但是我还是要熟悉一些常见的属性方法，以使我们能够<strong>快速出图</strong>，至于最终成图的细节则可以再细扣</p>
<p>另外，以下所有均来自<u>Matplotlib3.5官方文档</u>，一些参数细节暂不展开讲，在后续的总结中再慢慢铺开</p>
<h3 id="Figure"><a href="#Figure" class="headerlink" title="Figure"></a>Figure</h3><blockquote>
<p><code>class matplotlib.figure.Figure</code>, <a href="https://matplotlib.org/stable/api/figure_api.html#matplotlib.figure.Figure">类的属性及方法</a></p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="comment"># 创建一个 fig实例 </span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">5</span>, <span class="number">4</span>))</span><br><span class="line">fig, ax = plt.subplots()</span><br></pre></td></tr></table></figure>

<p>常用属性及方法&#x2F;函数：</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 创建时即可传参</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">matplotlib</span>.figure.Figure(figsize=<span class="literal">None</span>, dpi=<span class="literal">None</span>, facecolor=<span class="literal">None</span>, edgecolor=<span class="literal">None</span>, linewidth=<span class="number">0.0</span>, frameon=<span class="literal">None</span>, subplotpars=<span class="literal">None</span>, tight_layout=<span class="literal">None</span>, constrained_layout=<span class="literal">None</span>, *, layout=<span class="literal">None</span>, **kwargs)</span><br><span class="line"><span class="comment"># 添加子图</span></span><br><span class="line">.add_subplot()</span><br><span class="line">.add_axes()</span><br><span class="line">.subplots()</span><br><span class="line">.add_gridspec() <span class="comment">#复杂布局时使用</span></span><br><span class="line"><span class="comment"># 日期ticklabels自动调整，自动旋转以免叠盖</span></span><br><span class="line">.autofmt_xdate(bottom=<span class="number">0.2</span>, rotation=<span class="number">30</span>, ha=<span class="string">&#x27;right&#x27;</span>, which=<span class="string">&#x27;major&#x27;</span>)</span><br><span class="line"><span class="comment"># 添加色带</span></span><br><span class="line">.colorbar(mappable, cax=<span class="literal">None</span>, ax=<span class="literal">None</span>, use_gridspec=<span class="literal">True</span>, **kw)</span><br><span class="line"><span class="comment"># 放置图例</span></span><br><span class="line">.legend()</span><br><span class="line"><span class="comment"># 设置标题、文本</span></span><br><span class="line">.suptitle()</span><br><span class="line">.supxlabel(); .supylabel()</span><br><span class="line">.text(x, y, s, fontdict=<span class="literal">None</span>, **kwargs)</span><br><span class="line"><span class="comment"># 保存，常用，常用设置会在另一篇文章展开</span></span><br><span class="line">.savefig(fname, *, dpi=<span class="string">&#x27;figure&#x27;</span>, <span class="built_in">format</span>=<span class="literal">None</span>, metadata=<span class="literal">None</span>,</span><br><span class="line">        bbox_inches=<span class="literal">None</span>, pad_inches=<span class="number">0.1</span>,</span><br><span class="line">        facecolor=<span class="string">&#x27;auto&#x27;</span>, edgecolor=<span class="string">&#x27;auto&#x27;</span>,</span><br><span class="line">        backend=<span class="literal">None</span>, **kwargs)</span><br><span class="line"><span class="comment"># 设置各种属性，可以一次性设置多个参数，详见文档</span></span><br><span class="line">.<span class="built_in">set</span>(*...)</span><br><span class="line">.set_label(s)</span><br><span class="line">.set_alpha(alpha)</span><br><span class="line">.set_constrained_layout(constrained)</span><br><span class="line">.set_constrained_layout_pads(*, w_pad=<span class="literal">None</span>, h_pad=<span class="literal">None</span>, wspace=<span class="literal">None</span>, hspace=<span class="literal">None</span>)</span><br><span class="line">.set_dpi(); .set_edgecolor; .set_facecolor()...</span><br><span class="line"><span class="comment"># 获取</span></span><br><span class="line">.gca()  <span class="comment">#当前axes</span></span><br><span class="line">.get_axes()</span><br><span class="line">.get_children()</span><br><span class="line">.get_edgecolor(); .get_facecolor()</span><br><span class="line">.get_figheight(); .get_figwidth()</span><br></pre></td></tr></table></figure>

<h3 id="🔥Axes-绘图区"><a href="#🔥Axes-绘图区" class="headerlink" title="🔥Axes-绘图区"></a>🔥Axes-绘图区</h3><blockquote>
<p><code>class matplotlib.axes.Axes</code>，<a href="https://matplotlib.org/stable/api/axes_api.html#the-axes-class">类的属性及方法</a></p>
</blockquote>
<p>创建，有很多种方式</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#常用</span></span><br><span class="line">fig, ax = plt.subplots(ncols=<span class="number">2</span>, nrows=<span class="number">3</span>, figsize=(<span class="number">12</span>,<span class="number">8</span>))</span><br><span class="line">axs[<span class="number">2</span>, <span class="number">0</span>].plot([<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]) <span class="comment">#在第三行第一列绘图</span></span><br><span class="line">ax_list = ax.flatten() <span class="comment">#可以遍历获取各个axes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一张图,一个axes,</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">10</span>, <span class="number">8</span>))</span><br><span class="line">ax = fig.add_subplot(<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, aspect=<span class="number">1</span>)<span class="comment"># aspect是xy横纵比</span></span><br><span class="line">ax = fig.add_subplot(<span class="number">111</span>, aspect=<span class="number">1</span>)</span><br><span class="line"><span class="comment">#创建两个axes,一行两列</span></span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax1,ax2 = fig.add_subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, aspect=<span class="number">1</span>),fig.add_subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, aspect=<span class="number">1</span>)</span><br><span class="line">plt.show()</span><br><span class="line"><span class="comment">#创建两个axes,两行一列</span></span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax1,ax2 = fig.add_subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">1</span>, aspect=<span class="number">1</span>),fig.add_subplot(<span class="number">1</span>, <span class="number">2</span>, <span class="number">2</span>, aspect=<span class="number">1</span>)</span><br><span class="line">plt.show()</span><br><span class="line"></span><br><span class="line"><span class="comment">#创建共享x、y轴的axes，左右双图</span></span><br><span class="line">axes.twinx() </span><br><span class="line">axes.twiny()</span><br><span class="line">.sharex()<span class="comment"># 也可以手动设置/绑定axes</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 大小不一多子图的复杂布局，使用gridspec，具体查阅文档</span></span><br><span class="line">fig = plt.figure(constrained_layout=<span class="literal">True</span>)</span><br><span class="line">gs = fig.add_gridspec(<span class="number">3</span>, <span class="number">3</span>) <span class="comment">#初始九个图</span></span><br><span class="line">f_ax1 = fig.add_subplot(gs[<span class="number">0</span>, :]) <span class="comment">#合并了第一行的三个图，现在变成7张图</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure>

<p>绘图（快速绘图）</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">.plot() <span class="comment">#折线图</span></span><br><span class="line">.scatter() <span class="comment">#散点图</span></span><br><span class="line">.bar() <span class="comment">#柱状图</span></span><br><span class="line">.pie() <span class="comment">#饼图</span></span><br><span class="line">.hist() <span class="comment">#直方图</span></span><br><span class="line">.boxplot() <span class="comment"># 箱线图</span></span><br><span class="line">.hexbin(); .hist2d() <span class="comment">#二维直方图，√大量数据的相关性展示可用</span></span><br><span class="line">.stackplot() <span class="comment">#堆积柱状图</span></span><br><span class="line">.violinplot() <span class="comment">#小提琴图</span></span><br><span class="line">.imshow() <span class="comment">#绘制图片，二维矩阵栅格</span></span><br><span class="line"><span class="comment"># ...接口很多，还可以绘制洋流图、等高线、频谱图等</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 绘制x y辅助线</span></span><br><span class="line">.vlines() <span class="comment">#竖线</span></span><br><span class="line">.hlines() <span class="comment">#横线</span></span><br><span class="line"><span class="comment"># 水平填充、垂直填充、任意填充</span></span><br><span class="line">.fill_between()</span><br><span class="line">.fill_betweenx()</span><br><span class="line">.fill()</span><br></pre></td></tr></table></figure>

<p>添加注释</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">.annotate() <span class="comment">#添加注释</span></span><br><span class="line">.text() <span class="comment">#添加注释</span></span><br><span class="line">.secondary_xaxis() <span class="comment">#添加水平轴；可以实现上下双刻度线，具体见文档</span></span><br><span class="line">.secondary_yaxis() <span class="comment">#添加垂直边；可以实现左右双刻度线</span></span><br><span class="line">.arrow() <span class="comment">#添加箭头</span></span><br><span class="line">.inset_axes() <span class="comment">#添加注释，插入子图</span></span><br><span class="line">.table() <span class="comment">#添加注释</span></span><br></pre></td></tr></table></figure>

<p>要素属性设置</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">.set_xlim(); .get_xlim()<span class="comment"># 设置显示的范围，有set一般都有get</span></span><br><span class="line">.set_ylim()</span><br><span class="line">.set_xbound(); .set_ybound()<span class="comment"># 设置上下界</span></span><br><span class="line">.set_xlabel();.set_ylabel() <span class="comment">#设置标签</span></span><br><span class="line"></span><br><span class="line">.set_title() <span class="comment">#设置标题</span></span><br><span class="line">.set_xticks(); y... <span class="comment">#设置刻度值</span></span><br><span class="line">.set_xticklabels() <span class="comment">#设置刻度标签</span></span><br><span class="line">.minorticks_off(); .minorticks_on() <span class="comment">#次刻度的显示设置</span></span><br><span class="line">.ticklabel_format() <span class="comment">#格式化labels，如可以设置科学计数法显示</span></span><br><span class="line">.tick_params() <span class="comment"># 各种参数包括网格线等的设置</span></span><br><span class="line">.locator_params() <span class="comment">#设置主刻度线，高级自定义</span></span><br><span class="line">.set_position() <span class="comment">#设置图像在图中的位置，比如可以设置绘图左下角起点</span></span><br><span class="line"></span><br><span class="line">.set_xscale() <span class="comment">#设置刻度变换</span></span><br><span class="line">.set_yscale()</span><br><span class="line">.set_xmargin() <span class="comment">#设置绘制图形距离边/spines的距离,变相裁剪</span></span><br><span class="line">.set_ymargin() </span><br><span class="line">.set_aspect() <span class="comment">#设置轴缩放的横纵比</span></span><br><span class="line"></span><br><span class="line">.legend() <span class="comment">#设置图例</span></span><br><span class="line">h, l = ax.get_legend_handles_labels() <span class="comment">#获取图例句柄及标签</span></span><br><span class="line">.invert_xaxis();.invert_yaxis() <span class="comment">#设置轴的增大方向</span></span><br></pre></td></tr></table></figure>

<p>外观开关设置</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">.set_axis_off()</span><br><span class="line">.set_axis_on()</span><br><span class="line">.grid()</span><br><span class="line">.get_facecolor()</span><br><span class="line">.set_facecolor()</span><br><span class="line">.get_xaxis() <span class="comment">#获取XAxis实例</span></span><br><span class="line">.get_yaxis()</span><br></pre></td></tr></table></figure>

<p>元素添加及参考系变换等，我们可以自行创建任意的图像然后添加到axes中</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">.add_artist()</span><br><span class="line">.add_child_axes()</span><br><span class="line">.add_collection()</span><br><span class="line">.add_image()</span><br><span class="line">.add_line()</span><br><span class="line">.add_patch()</span><br><span class="line">.add_table()</span><br><span class="line"><span class="comment"># 轴的标准化坐标0-1和实际坐标的变换可能用到，具体用法在另一篇展开</span></span><br><span class="line">.get_xaxis_transform</span><br><span class="line">.get_yaxis_transform</span><br></pre></td></tr></table></figure>

<h3 id="Spines-边框"><a href="#Spines-边框" class="headerlink" title="Spines-边框"></a>Spines-边框</h3><blockquote>
<p><code>class matplotlib.spines.Spine</code>，<a href="https://matplotlib.org/stable/api/spines_api.html">类的属性及方法</a></p>
</blockquote>
<p>属性设置</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment">#获取和设置显示/隐藏边框</span></span><br><span class="line">ax.spines[<span class="string">&#x27;top&#x27;</span>].set_visible(<span class="literal">False</span>)</span><br><span class="line">ax.spines.top.set_visible(<span class="literal">False</span>)</span><br><span class="line">ax.spines[[<span class="string">&#x27;top&#x27;</span>, <span class="string">&#x27;right&#x27;</span>]].set_visible(<span class="literal">False</span>)</span><br><span class="line">ax.spines[:].set_visible(<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># 其他</span></span><br><span class="line">.set_bounds(low=<span class="literal">None</span>, high=<span class="literal">None</span>)</span><br><span class="line">.set_color(c)  <span class="comment"># 设置颜色</span></span><br><span class="line">.set_position(position)<span class="comment">#常用，设置位置</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 更改边界线的形状，实际上axes依旧是矩形</span></span><br><span class="line">.set_patch_circle() <span class="comment"># 设置为圆形</span></span><br><span class="line">set_patch_arc(center, radius, theta1, theta2)</span><br></pre></td></tr></table></figure>

<h3 id="Text-文本"><a href="#Text-文本" class="headerlink" title="Text-文本"></a>Text-文本</h3><blockquote>
<p><code>class matplotlib.text.Text</code>，<a href="https://matplotlib.org/stable/api/text_api.html">类的属性及方法</a></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">class matplotlib.text.Text(x=0, y=0, text=&#x27;&#x27;, color=None, ...)</span><br><span class="line"># 先添加文本</span><br><span class="line">text = ax.text(s = &quot;注释&quot;,x,y,c = &#x27;r&#x27;...)# 可以通过这样的方式获取文本示例再设置属性</span><br><span class="line"># 批量设置</span><br><span class="line">.set(*, agg_filter=&lt;UNSET&gt;, alpha=&lt;UNSET&gt;, animated=&lt;UNSET&gt;,...)</span><br></pre></td></tr></table></figure>

<p>属性具体设置</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">.set_text(s) <span class="comment">#设置字的内容 </span></span><br><span class="line">.set_position((x,y))<span class="comment">#设置字的位置</span></span><br><span class="line">.set_x(x)</span><br><span class="line">.set_bbox(rectprops) <span class="comment">#设置字体外边框</span></span><br><span class="line">.set_color(color); .set_c(color)</span><br><span class="line"><span class="comment"># 字体及大小</span></span><br><span class="line">.set_font(fp); .set_fontproperties()</span><br><span class="line">.set_family.(); .set_fontfamily()</span><br><span class="line">.set_fontsize(fontsize)</span><br><span class="line"><span class="comment"># 设置加粗倾斜等</span></span><br><span class="line">.set_fontstyle(fontstyle);<span class="comment">#设置斜体&#123;&#x27;normal&#x27;, &#x27;italic&#x27;, &#x27;oblique&#x27;&#125;</span></span><br><span class="line">.set_fontweight(weight) <span class="comment">#字体粗细，&#123;a numeric value in range 0-1000, &#x27;ultralight&#x27;, &#x27;light&#x27;, &#x27;normal&#x27;, &#x27;regular&#x27;, &#x27;book&#x27;, &#x27;medium&#x27;, &#x27;roman&#x27;, &#x27;semibold&#x27;, &#x27;demibold&#x27;, &#x27;demi&#x27;, &#x27;bold&#x27;, &#x27;heavy&#x27;, &#x27;extra bold&#x27;, &#x27;black&#x27;&#125;</span></span><br><span class="line"><span class="comment"># 对齐方式</span></span><br><span class="line">.set_ha(align); </span><br><span class="line">.set_horizontalalignment(align)<span class="comment"># align&#123;&#x27;center&#x27;, &#x27;right&#x27;, &#x27;left&#x27;&#125;</span></span><br><span class="line"><span class="comment"># 旋转角度</span></span><br><span class="line">.set_rotation(s) <span class="comment">#float or &#123;&#x27;vertical&#x27;, &#x27;horizontal&#x27;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 行间距，默认1.2</span></span><br><span class="line">.set_linespacing(spacing)</span><br><span class="line"><span class="comment"># 数学公式，生效的前提是未设置全局Tex,(usetex=True).</span></span><br><span class="line">.set_math_fontfamily(fontfamily)</span><br><span class="line">.set_usetex(usetex=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">.update(kwargs) <span class="comment">#dict，传入字典更新其属性</span></span><br><span class="line">.update_from(other)</span><br></pre></td></tr></table></figure>

<h2 id="后续"><a href="#后续" class="headerlink" title="后续"></a>后续</h2><blockquote>
<p>待办</p>
</blockquote>
<ol>
<li>绘图逻辑与思路</li>
<li>Matplotlib绘图初始设置模板（包含风格、字体等等的初始化）</li>
<li>Matplotlib图片输出设置，空间占用与dpi的权衡……</li>
<li>绘图布局详解及案例</li>
<li>色彩及色带详解及案例</li>
<li>时间序列刻度详解及案例</li>
<li>文本及注释详解</li>
<li>其他绘图库了解及探索</li>
<li>地图绘制……</li>
<li>……</li>
</ol>
]]></content>
      <categories>
        <category>Python可视化之Matplotlib</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Matplotlib</tag>
      </tags>
  </entry>
  <entry>
    <title>Pandas拆分及合并字符串列</title>
    <url>/posts/374675e0/</url>
    <content><![CDATA[<p>pandas处理表格时，<strong>字符串</strong>列的<u>拆分及合并</u>操作，类似于excel中的分列</p>
<ol>
<li>根据分隔符将一列<strong>拆</strong>成多列</li>
<li>将多列进行<strong>合并</strong></li>
</ol>
<span id="more"></span>

<img src="/posts/374675e0/image-20220531130906473.png" class alt="image-20220531130906473">



<h2 id="分列"><a href="#分列" class="headerlink" title="分列"></a>分列</h2><blockquote>
<p>参考api介绍: <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.str.split.html">Series.str.split()</a></p>
<p>该方法支持正则表达式</p>
</blockquote>
<p>处理高德Poi数据时发现有一列<strong>typename</strong>是这样的：</p>
<ul>
<li>汽车服务;汽车服务相关;汽车服务相关</li>
<li>生活服务;人才市场;人才市场</li>
<li>餐饮服务;中餐厅;中餐厅</li>
</ul>
<p>分别代表大中小类别，因此通过如下代码切分</p>
<ul>
<li><code>expand=True</code>表示将拆分的字符串展开为单独的列</li>
<li><code>n</code>指定拆分的分隔符个数，默认0&#x2F;-1全部拆分</li>
</ul>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 测试数据，原始df过大</span></span><br><span class="line">df_sample = df.sample(<span class="number">500</span>)</span><br><span class="line"><span class="comment"># 直接切分，预览结果发现得到五列，后两列大量为None,有的小类过细</span></span><br><span class="line">df_sample[<span class="string">&#x27;typename&#x27;</span>].<span class="built_in">str</span>.split(<span class="string">&#x27;;&#x27;</span>, expand=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 因此最终的切分代码</span></span><br><span class="line">df_sample[[<span class="string">&#x27;type1&#x27;</span>, <span class="string">&#x27;type2&#x27;</span>, <span class="string">&#x27;type3&#x27;</span>]] = df_sample[<span class="string">&#x27;typename&#x27;</span>].<span class="built_in">str</span>.split(<span class="string">&#x27;;&#x27;</span>, n=<span class="number">2</span>, expand=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h2 id="合并"><a href="#合并" class="headerlink" title="合并"></a>合并</h2><blockquote>
<p>参考api介绍: <a href="https://pandas.pydata.org/docs/reference/api/pandas.Series.str.cat.html">Series.str.cat()</a></p>
<p>补充的其他方法，另见<a href="https://sparkbyexamples.com/pandas/pandas-combine-two-columns-of-text-in-dataframe/">参考2</a></p>
</blockquote>
<p>确保各类为文本&#x2F;字符串类型，否则先转换</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># df[&#x27;type1&#x27;] = df[&#x27;type1&#x27;].astype(str)</span></span><br><span class="line"><span class="comment"># 最直接的是字符串相加</span></span><br><span class="line">df_sample[<span class="string">&quot;typename2&quot;</span>] = df_sample[<span class="string">&#x27;type1&#x27;</span>].astype(<span class="built_in">str</span>) +<span class="string">&quot;-&quot;</span>+ df_sample[<span class="string">&quot;type2&quot;</span>]+<span class="string">&quot;-&quot;</span>+ df_sample[<span class="string">&quot;type3&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并方式2</span></span><br><span class="line">df_sample[<span class="string">&#x27;typename2&#x27;</span>] = df_sample[<span class="string">&#x27;type1&#x27;</span>].<span class="built_in">str</span>.cat(df_sample[[<span class="string">&#x27;type2&#x27;</span>, <span class="string">&#x27;type3&#x27;</span>]], sep=<span class="string">&#x27;,&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用字符串join函数</span></span><br><span class="line">df[<span class="string">&quot;typename2&quot;</span>] = df[[<span class="string">&#x27;type1&#x27;</span>, <span class="string">&#x27;type2&#x27;</span>, <span class="string">&#x27;type3&#x27;</span>]].apply(<span class="string">&quot;-&quot;</span>.join, axis=<span class="number">1</span>)</span><br><span class="line">df[<span class="string">&quot;typename2&quot;</span>] = df[[<span class="string">&#x27;type1&#x27;</span>, <span class="string">&#x27;type2&#x27;</span>, <span class="string">&#x27;type3&#x27;</span>]].agg(<span class="string">&quot;-&quot;</span>.join, axis=<span class="number">1</span>)</span><br><span class="line">df[<span class="string">&quot;typename2&quot;</span>] = df[[<span class="string">&#x27;type1&#x27;</span>, <span class="string">&#x27;type2&#x27;</span>, <span class="string">&#x27;type3&#x27;</span>]].apply(<span class="keyword">lambda</span> x: <span class="string">&quot;-&quot;</span>.join(x), axis =<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Pandas数据处理</category>
      </categories>
      <tags>
        <tag>pandas.str</tag>
      </tags>
  </entry>
  <entry>
    <title>Python中的时间格式及转换梳理</title>
    <url>/posts/a0dd2ef9/</url>
    <content><![CDATA[<p>时间格式是一类较特殊也十分普遍的格式，大量数据都含有时间信息，在实际的学习中会经常接触。最近有创建、处理或转换时间序列数据的需求，因此做一个梳理并汇总以便在后续遇到相关处理时可以拿来即用。本文主要涉及内容：</p>
<ol>
<li>Python内置模块<code>time</code> 及 <code>datetime</code>的时间格式及处理</li>
<li><code>Pandas</code>时间格式的表达及常规处理</li>
<li>实际作业中遇到的一些<code>案例</code></li>
</ol>
<span id="more"></span>

<h2 id="主要参考"><a href="#主要参考" class="headerlink" title="主要参考"></a>主要参考</h2><blockquote>
<p>不论是Python的内置模块还是第三方提供的模块，官网的文档都是很好的学习资源，尤其是想要了解地更深的时候或者debug的时候</p>
</blockquote>
<ul>
<li><a href="https://strftime.org/">https://strftime.org/</a></li>
</ul>
<p>Python官方文档</p>
<ul>
<li><a href="https://docs.python.org/3.9/library/index.html">python标准库</a></li>
<li><a href="https://docs.python.org/3.9/library/time.html">time模块文档</a></li>
<li><a href="https://docs.python.org/3.9/library/time.html">datetime模块文档</a></li>
</ul>
<p>NumPy</p>
<ul>
<li><a href="https://numpy.org/doc/stable/reference/arrays.datetime.html">NumPy中的日期和时间</a></li>
<li><a href="https://numpy.org/doc/stable/reference/routines.datetime.html">时间转换函数</a></li>
</ul>
<p>Pandas，pandas主要处理表格型数据，因此实际中数据以时间序列存在</p>
<ul>
<li><a href="https://pandas.pydata.org/docs/user_guide/timeseries.html">时间序列相关处理函数</a></li>
<li><a href="https://pandas.pydata.org/docs/user_guide/timedeltas.html#">时间增量&#x2F;差</a></li>
</ul>
<p>涉及Python模块和类、实例、属性及方法相关相关的概念可查阅此文<a href="https://hscyber.github.io/posts/659ef075/">Python中的类</a></p>
<hr>
<h2 id="内置模块time"><a href="#内置模块time" class="headerlink" title="内置模块time"></a>内置模块time</h2><h3 id="表达格式"><a href="#表达格式" class="headerlink" title="表达格式"></a>表达格式</h3><ol>
<li><p><strong>数字</strong> &lt;’float’&gt;，Unix时间戳：从epoch(1970年1月1日00:00:00 UTC)经过的秒数&#x2F;偏移量，如631123200000表示”1990-01-01 00:00:00”</p>
</li>
<li><p><strong>时间元组</strong> &lt; ‘time.struct_time’&gt;（实际实现，给计算机看的）包含了一个时间的完整信息</p>
<ul>
<li>time.struct_time(tm_year&#x3D;2022, tm_mon&#x3D;5, tm_mday&#x3D;11, tm_hour&#x3D;2, tm_min&#x3D;53, tm_sec&#x3D;2, tm_wday&#x3D;2, tm_yday&#x3D;131, tm_isdst&#x3D;0)</li>
</ul>
</li>
<li><p><strong>字符串</strong> &lt;’str’&gt;（可读性强，给人看的）：如”1990-01-01 00:00:00”，”2018-01-01”，”1998&#x2F;01&#x2F;01”等</p>
</li>
</ol>
<h3 id="时间获取"><a href="#时间获取" class="headerlink" title="时间获取"></a>时间获取</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># print(&quot;获取计算机当前时间时间：&#123;0&#125;,数据类型：&#123;1&#125;&quot;.format(t, type(t)))</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">t = time.time()</span><br><span class="line"><span class="comment"># 1652701116.7288237,数据类型: &lt;class &#x27;float&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line">t = time.ctime()</span><br><span class="line"><span class="comment"># Mon May 16 19:38:36 2022,数据类型：&lt;class &#x27;str&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line">t = time.gmtime()</span><br><span class="line"><span class="comment"># time.struct_time(tm_year=2022, tm_mon=5, tm_mday=16, tm_hour=11, tm_min=38, tm_sec=36, tm_wday=0, tm_yday=136, tm_isdst=0),数据类型：&lt;class &#x27;time.struct_time&#x27;&gt;</span></span><br><span class="line"></span><br><span class="line">t = time.localtime() <span class="comment">#逆操作time.mktime()：可以将数字转换成元组</span></span><br><span class="line"><span class="comment">#同上 time.struct_time(tm..</span></span><br></pre></td></tr></table></figure>

<h3 id="单个时间转换-strftime-strptime"><a href="#单个时间转换-strftime-strptime" class="headerlink" title="单个时间转换(strftime()+strptime())"></a>单个时间转换(<code>strftime()+strptime()</code>)</h3><p>将时间元组转换为格式化字符串</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">t_struct = time.gmtime() <span class="comment">#创建时间元组</span></span><br><span class="line">t_string = time.strftime(<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>, t_struct)</span><br></pre></td></tr></table></figure>

<p>将字符串转换为时间元组</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">t_string = <span class="string">&#x27;2022-05-16 13:16:15&#x27;</span></span><br><span class="line">t_struct = time.strptime(t_string,<span class="string">&quot;%Y-%m-%d %H:%M:%S&quot;</span>)</span><br></pre></td></tr></table></figure>

<p>所有格式化参数可以在此页面查找<a href="https://strftime.org/">strftime()</a><br>常用的如下（注意区分大小写）：</p>
<ul>
<li><code>%Y %m %d</code>: 2022-05-01, <code>%Y %-m %-d</code>: 2022-5-1,</li>
<li><code>%H %M %S</code>: 05:01:08, <code>%-H %-M %-S</code>: 5:1:8,</li>
<li><code>%x</code>:’05&#x2F;11&#x2F;22’, </li>
<li><code>%X</code>:’’02:49:06’, </li>
<li><code>%c</code>: ‘Wed May 11 02:49:36 2022’</li>
<li><code>%a</code>: Sun, <code>%A</code>: Sunday, <code>%W</code>:0-6,weekday</li>
<li><code>%b</code>: Jan, <code>%B</code>: January,</li>
<li>…</li>
<li><code>%z</code>: UTC offset in the form +HHMM or -HHMM.  “%z %Z”:’+0800 中国标准时间’</li>
<li><code>%j</code>: 001, 002, …, 366, </li>
<li><code>%U</code> <code>%W</code>：周数，一年的第多少周，前者表示周日为第一天</li>
</ul>
<h3 id="其他函数"><a href="#其他函数" class="headerlink" title="其他函数"></a>其他函数</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 脚本运行时间计算</span></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">start_time = time.time()</span><br><span class="line">main()<span class="comment">#需要计时的代码</span></span><br><span class="line">end_time = time.time()</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;脚本运行总时长:&#123;:.2f&#125; min&#x27;</span>.<span class="built_in">format</span>((end_time-start_time)/<span class="number">60</span>))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;脚本运行总时长:&#123;:.2f&#125; h&#x27;</span>.<span class="built_in">format</span>((end_time-start_time)/<span class="number">3600</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 代码停顿3秒</span></span><br><span class="line">time.sleep(<span class="number">3</span>)</span><br></pre></td></tr></table></figure>

<hr>
<h2 id="🔥内置模块datetime"><a href="#🔥内置模块datetime" class="headerlink" title="🔥内置模块datetime"></a>🔥内置模块datetime</h2><blockquote>
<p>time较为底层，一般用的不多，其他实际中主要用datetime<br>datetime是基于time包开发的包，datetime可以拆解为date和time两个部分。可以将这两个分开管理(datetime.date类，datetime.time类)，也可以将两者合在一起(datetime.datetime类)，datetime包还定义了时间间隔对象(timedelta)。</p>
</blockquote>
<h3 id="子类-x2F-对象"><a href="#子类-x2F-对象" class="headerlink" title="子类&#x2F;对象"></a>子类&#x2F;对象</h3><p>类，这些类可以直接通过”属性”进行实例化对象，如datetime.date(2022, 5, 20)</p>
<ul>
<li><code>datetime.time</code>：独立于任何特定日期的理想化时间，包含属性: <u>hour, minute, second</u>, microsecond 和 tzinfo。<ul>
<li>属性的意思表明可以通过 .month .hour获取对象实例的属性值</li>
</ul>
</li>
<li><code>datetime.date</code>: 理想化的简单型日期, 属性: <u>year, month, and day</u>。</li>
<li><code>datetime.datetime</code>: 日期和时间的结合。属性：<u>year, month, day, hour, minute, second</u>, microsecond, and tzinfo.</li>
<li><code>datetime.timedelta</code>：表示两个 date 对象或 time 对象，或者 datetime 对象之间的<u>时间间隔</u>，精确到微秒。<ul>
<li>常用于时间之间的加减等操做</li>
</ul>
</li>
<li><code>datetime.tzinfo</code>：时区信息对象</li>
<li><code>datetime.timezone</code>：表示相对于UTC的偏移量</li>
</ul>
<p>这些类创建实例的<strong>共有属性</strong></p>
<ol>
<li>不可变</li>
<li>可哈希，即可以作为字典的键key</li>
<li>支持通过pickle模块进行高效封存，惯用pickle可以为实际工作带来诸多便利，见<a href>pickle使用-待更新</a></li>
<li>支持加减法，且涉及时间间隔及时间差等可以通过<strong>timedelta</strong>进行运算</li>
</ol>
<h3 id="date常用操作"><a href="#date常用操作" class="headerlink" title="date常用操作"></a>date常用操作</h3><blockquote>
<p>time的操作与之类似</p>
</blockquote>
<ul>
<li><p>获取&#x2F;创建时间</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> date, timedelta</span><br></pre></td></tr></table></figure></li>
</ul>
<p>today &#x3D; date.today() #输出 datetime.date(2022, 5, 16)<br>year, month &#x3D; today.year, today.month</p>
<p>my_birthday &#x3D; date(1998, 1, 1)<br>time_to_birthday &#x3D; abs(my_birthday - today) # datetime.timedelta(days&#x3D;8901)</p>
<h1 id="UTC时间转北京时间：time-bj-x3D-time-utc-timedelta-hours-x3D-8"><a href="#UTC时间转北京时间：time-bj-x3D-time-utc-timedelta-hours-x3D-8" class="headerlink" title="UTC时间转北京时间：time_bj &#x3D; time_utc+ timedelta(hours&#x3D;8)"></a>UTC时间转北京时间：time_bj &#x3D; time_utc+ timedelta(hours&#x3D;8)</h1><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">- 日期与字符串格式的转换</span><br><span class="line"></span><br><span class="line">将时间date转换为格式化字符串</span><br><span class="line">```python</span><br><span class="line">from datetime import date</span><br><span class="line">t1 = date(2022, 1, 1) </span><br><span class="line">#  ISO 8601 格式 YYYY-MM-DD</span><br><span class="line">t_string = date.isoformat(t1) #&#x27;2022-01-01&#x27;</span><br></pre></td></tr></table></figure>

<p>将字符串转换为日期date</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">t1 = <span class="string">&#x27;2022-01-01&#x27;</span></span><br><span class="line">t_date = date.fromisoformat(t1) <span class="comment">#输出datetime.date(2022, 1, 1)</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>其他方法<br>时间替换<code>date.replace</code>(year&#x3D;self.year, month&#x3D;self.month, day&#x3D;self.day)</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">d = date(<span class="number">2022</span>, <span class="number">12</span>, <span class="number">31</span>)</span><br><span class="line"><span class="comment"># 时间替换</span></span><br><span class="line">d2 = d.replace(day=<span class="number">26</span>)</span><br><span class="line"><span class="comment">#返回一个 time.struct_time</span></span><br><span class="line">d3 = date.timetuple(d) </span><br><span class="line"><span class="comment"># 获取当前时间的字符串格式</span></span><br><span class="line">t = date.today()</span><br><span class="line">t.ctime()<span class="comment"># 等价于`time.ctime(time.mktime(d.timetuple()))`</span></span><br><span class="line"><span class="comment">#输出&#x27;Mon May 16 00:00:00 2022&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="🔥datetime常用操作"><a href="#🔥datetime常用操作" class="headerlink" title="🔥datetime常用操作"></a>🔥datetime常用操作</h3><ul>
<li><p>获取&#x2F;创建时间</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, date, time, timezone</span><br><span class="line">datetime.now()   </span><br><span class="line">datetime.now(timezone.utc)</span><br><span class="line"><span class="comment"># 年月日等属性获取,date()</span></span><br><span class="line">t = datetime.now()</span><br><span class="line">year,month, udate = t.year, t.month, t.date()</span><br><span class="line"><span class="comment">#输出</span></span><br><span class="line"><span class="comment"># datetime.datetime(2022, 5, 16, 21, 10, 32, 304773)</span></span><br><span class="line"><span class="comment"># datetime.datetime(2022, 5, 16, 13, 10, 32, 306332, tzinfo=datetime.timezone.utc)</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>时间合并</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime, date, time</span><br><span class="line">d = date(<span class="number">2022</span>, <span class="number">5</span>, <span class="number">12</span>)</span><br><span class="line">t = time(<span class="number">1</span>, <span class="number">18</span>)</span><br><span class="line">dt = datetime.combine(d, t)</span><br></pre></td></tr></table></figure>
</li>
<li><p>时间与字符串的转换，参数与<code>time</code>模块类似</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 字符串转时间</span></span><br><span class="line">dt = datetime.strptime(<span class="string">&quot;21/11/06 16:30&quot;</span>, <span class="string">&quot;%d/%m/%y %H:%M&quot;</span>)</span><br><span class="line"><span class="comment"># 时间转字符串</span></span><br><span class="line">t_str = dt.strftime(<span class="string">&quot;%d/%m/%y %H:%M&quot;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h2 id="Pandas中的时间格式"><a href="#Pandas中的时间格式" class="headerlink" title="Pandas中的时间格式"></a>Pandas中的时间格式</h2><blockquote>
<p>pandas为表格，因此处理的一般为时间序列而非单个时间</p>
</blockquote>
<p>pandas中的时间格式主要为以下两类</p>
<ul>
<li>datetime (datetime64[ns])， 类比datetime</li>
<li>String&#x2F;Object</li>
</ul>
<h3 id="创建序列"><a href="#创建序列" class="headerlink" title="创建序列"></a>创建序列</h3><blockquote>
<p>pd.date_range()</p>
</blockquote>
<ul>
<li>pandas.date_range(start&#x3D;None, end&#x3D;None, periods&#x3D;None, freq&#x3D;None, tz&#x3D;None, normalize&#x3D;False, name&#x3D;None, …)<a href="https://pandas.pydata.org/docs/reference/api/pandas.date_range.html">文档</a></li>
<li>参数说明<ul>
<li><code>start end</code>:起始日期</li>
<li><code>periods</code>:日期数量</li>
<li><code>freq</code>: 间隔，默认<code>D</code>,可以设<code>M</code>,<code>8H</code><a href="https://pandas.pydata.org/docs/user_guide/timeseries.html#timeseries-offset-aliases">详见</a></li>
<li><code>inclusive</code>：&#x3D;’both’,’left’,’right’，’neither’指定左右是否闭合，如生成某月份数据但不知道该月多少天，可以指定为left，右边写下月第一天</li>
</ul>
</li>
</ul>
<p>常用代码</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 创建序列， 可以直接接收</span></span><br><span class="line"><span class="comment"># 默认都是ISO 8601 格式 YYYY-MM-DD, &#x27;2018-01-01 03:00:00&#x27;</span></span><br><span class="line">df[<span class="string">&#x27;time&#x27;</span>] = pd.date_range(start=<span class="string">&#x27;1/1/2018&#x27;</span>, end=<span class="string">&#x27;1/08/2018&#x27;</span>, freq=<span class="string">&#x27;D&#x27;</span>) <span class="comment">#8天</span></span><br><span class="line">pd.date_range(start=<span class="string">&#x27;1/1/2018&#x27;</span>, end=<span class="string">&#x27;1/08/2018&#x27;</span>) <span class="comment">#8天</span></span><br><span class="line">pd.date_range(start=<span class="string">&#x27;1/1/2018&#x27;</span>, periods=<span class="number">8</span>) <span class="comment">#8天</span></span><br><span class="line">pd.date_range(start=<span class="string">&#x27;1/1/2018&#x27;</span>, periods=<span class="number">8</span>, freq=<span class="string">&#x27;2M&#x27;</span>)  <span class="comment">#8天，两天之间间隔为两个月</span></span><br><span class="line">pd.date_range(start=<span class="string">&#x27;2018-01-01&#x27;</span>, end=<span class="string">&#x27;2018-02-01&#x27;</span>, freq=<span class="string">&#x27;3H&#x27;</span>)</span><br><span class="line">pd.date_range(start=<span class="string">&#x27;2017-01-01&#x27;</span>, end=<span class="string">&#x27;2017-02-01&#x27;</span>, inclusive=<span class="string">&#x27;left&#x27;</span>) <span class="comment">#创建指定月份的日期范围</span></span><br></pre></td></tr></table></figure>

<h3 id="🔥时间序列格式转换"><a href="#🔥时间序列格式转换" class="headerlink" title="🔥时间序列格式转换"></a>🔥时间序列格式转换</h3><p><strong>datetime→string</strong>:<code>astype()+strftime()</code>，输入的列为datetime64[ns]类型</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># astype()</span></span><br><span class="line">df[<span class="string">&#x27;time_str&#x27;</span>]=df[<span class="string">&#x27;time&#x27;</span>].astype(<span class="built_in">str</span>)</span><br><span class="line"><span class="comment"># strftime()</span></span><br><span class="line">df[<span class="string">&#x27;time_str&#x27;</span>] = df[<span class="string">&#x27;time&#x27;</span>].dt.strftime(<span class="string">&#x27;%m/%d/%Y&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p><strong>string→datetime</strong>: <code>to_datetime</code>，输入的列为String或Object类型</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line">df[<span class="string">&#x27;time&#x27;</span>]=pd.to_datetime(df[<span class="string">&#x27;time_str&#x27;</span>].astype(<span class="built_in">str</span>), <span class="built_in">format</span>=<span class="string">&#x27;%Y/%m/%d&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="时间合并与拆分"><a href="#时间合并与拆分" class="headerlink" title="时间合并与拆分"></a>时间合并与拆分</h3><figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 合并</span></span><br><span class="line">df = pd.DataFrame(&#123;<span class="string">&#x27;year&#x27;</span>: [<span class="number">2015</span>, <span class="number">2016</span>],<span class="string">&#x27;month&#x27;</span>: [<span class="number">2</span>, <span class="number">3</span>],<span class="string">&#x27;day&#x27;</span>: [<span class="number">4</span>, <span class="number">5</span>],<span class="string">&#x27;hour&#x27;</span>:[<span class="number">10</span>,<span class="number">20</span>]&#125;)</span><br><span class="line">df[<span class="string">&#x27;date&#x27;</span>] = pd.to_datetime(df[[<span class="string">&#x27;year&#x27;</span>,<span class="string">&#x27;month&#x27;</span>,<span class="string">&#x27;day&#x27;</span>]])</span><br><span class="line">df[<span class="string">&#x27;datetime&#x27;</span>] = pd.to_datetime(df.date) + pd.to_timedelta(df.hour, unit=<span class="string">&#x27;h&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#拆分/转换示例</span></span><br><span class="line">df[<span class="string">&#x27;day2&#x27;</span>] = df[<span class="string">&#x27;time&#x27;</span>].dt.strftime(<span class="string">&#x27;%D&#x27;</span>)</span><br><span class="line">df[<span class="string">&#x27;hour2&#x27;</span>] = df[<span class="string">&#x27;time&#x27;</span>].dt.strftime(<span class="string">&#x27;%H&#x27;</span>)</span><br><span class="line">df[<span class="string">&#x27;date2&#x27;</span>] = df[<span class="string">&#x27;time&#x27;</span>].dt.strftime(<span class="string">&#x27;%x&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h3 id="基于时间筛选数据"><a href="#基于时间筛选数据" class="headerlink" title="基于时间筛选数据"></a>基于时间筛选数据</h3><blockquote>
<p><code>&amp;</code>与;<code>|</code>或</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="comment"># df[&#x27;time&#x27;]为时间格式：</span></span><br><span class="line">df2 = df.loc[(df.time &gt; pd.datetime(<span class="number">2017</span>,<span class="number">8</span>,<span class="number">23</span>,<span class="number">0</span>)) &amp; (df.time &lt; pd.datetime(<span class="number">2017</span>,<span class="number">8</span>,<span class="number">27</span>,<span class="number">0</span>))]</span><br><span class="line">df2 = df.loc[(df.time &lt; pd.datetime(<span class="number">2017</span>,<span class="number">8</span>,<span class="number">23</span>,<span class="number">0</span>)) | (df.time &gt; pd.datetime(<span class="number">2017</span>,<span class="number">8</span>,<span class="number">27</span>,<span class="number">0</span>))]</span><br><span class="line"><span class="comment"># df[&#x27;time&#x27;]为字符串：</span></span><br><span class="line">df2 = df.loc[(df.time &gt; <span class="string">&#x27;2017-08-20 00:00:00&#x27;</span>) &amp; (df.time &lt; <span class="string">&#x27;2017-08-26 00:00:00&#x27;</span>)]</span><br></pre></td></tr></table></figure>

<h3 id="其他操作"><a href="#其他操作" class="headerlink" title="其他操作"></a>其他操作</h3><blockquote>
<p>待补充<br>……</p>
</blockquote>
<p>有了以上的基础，在实际中可以灵活按需涉及方案排列组合等实现想要的结果……</p>
<hr>
<h2 id="实际案例"><a href="#实际案例" class="headerlink" title="实际案例"></a>实际案例</h2><blockquote>
<p>持续扩充……</p>
</blockquote>
]]></content>
      <categories>
        <category>Python基础</category>
      </categories>
      <tags>
        <tag>Python</tag>
        <tag>Time</tag>
        <tag>Datetime</tag>
        <tag>pandas</tag>
      </tags>
  </entry>
  <entry>
    <title>文献篇 (1)论文检索</title>
    <url>/posts/33f7b1b7/</url>
    <content><![CDATA[<p>背景调研和文献整理是研究开展的必要过程，通常在明确问题之后首先就要进行一个较完整的文献梳理。</p>
<p>本文主要介绍<a href="https://scholar.google.com/">谷歌学术</a>以及<a href="https://www.connectedpapers.com/">Connected papers</a>的使用，侧重于英文文献，其他常用平台还有<a href="https://www.webofscience.com/wos/woscc/basic-search">Web Of Science</a>、<a href="https://www.cnki.net/">中国知网</a>。</p>
<span id="more"></span>

<img src="/posts/33f7b1b7/image-20220604165048854.png" class alt="image-20220604165048854">

<h2 id="Google-Scholar"><a href="#Google-Scholar" class="headerlink" title="Google Scholar"></a>Google Scholar</h2><blockquote>
<p><a href="https://scholar.google.com/">谷歌学术网址</a>，<strong>Stand on the shoulders of giants</strong></p>
<p>此平台也是一个很好的<strong>跟踪学者研究成果</strong>的平台</p>
</blockquote>
<h3 id="类型及时间筛选"><a href="#类型及时间筛选" class="headerlink" title="类型及时间筛选"></a>类型及时间筛选</h3><p>左侧设置搜索选项：</p>
<ul>
<li><p><strong>类型</strong>可以选择<strong>综述</strong>(review)或所有类型的文章（在论文投稿时会注明文章类型，其中包括review，因此平台可以识别）</p>
</li>
<li><p><strong>时间</strong>通常不受限，尤其是梳理研究历史和重要的文章的时候，也常设置近五年、三年或者近一年以追踪最近的成果进展</p>
</li>
</ul>
<h3 id="内容筛选"><a href="#内容筛选" class="headerlink" title="内容筛选"></a>内容筛选</h3><p>逻辑符(大写)：<strong>AND  OR</strong>，常见论文搜索&#x2F;组合方式（<strong>冒号后无空格</strong>）：</p>
<ul>
<li>关键词检索：typhoon resilience 或 typhoon+resilience 等价于typhoon AND resilience</li>
<li>短语关键词检索：”social resilience”</li>
<li>搜索标题：intitle<ul>
<li>intitle:(resilience typhoon)</li>
<li>intitle:((typhoon OR hurricane) AND (resilience))</li>
</ul>
</li>
<li>搜索作者：author:(“San Zhang” OR “Si Li”)</li>
<li>搜索期刊文献：”social resilience” <u>source</u>:”International Journal of Geographical Information Science”</li>
</ul>
<p><strong>我最常用的是标题检索，如：intitle:((typhoon OR hurricane) AND (resilience) AND “social media”)。</strong>想要更加广泛一点或者词组不一定包含在标题中时，则建议直接关键词组合，这样会默认检索论文全文信息。</p>
<h2 id="Connected-papers"><a href="#Connected-papers" class="headerlink" title="Connected papers"></a>Connected papers</h2><blockquote>
<p><a href="https://www.connectedpapers.com/">Find and explore academic papers</a>一个论文检索及管理、可视化梳理的平台</p>
<p>我通常用来找一个具体研究方向上<strong>被引量高</strong>的一些较为重要的文章</p>
</blockquote>
<img src="/posts/33f7b1b7/image-20220604170812558.png" class alt="image-20220604170812558">

<h3 id="作者的初衷"><a href="#作者的初衷" class="headerlink" title="作者的初衷"></a>作者的初衷</h3><p>多年来，我们一直感到学术文献回顾和探索的痛苦，并且一直在思考如何解决它。很多时候，我们找到了一篇有趣的论文，并且我们希望：<u>1. 查找针对同一主题的不同方法和方法；2. 追踪该领域的最新研究状况；3. 确定开创性作品和背景知识；4.探索并沉浸在主题中，并了解论文中的趋势和动态。</u>因此开发了这个平台</p>
<h3 id="怎么阅读"><a href="#怎么阅读" class="headerlink" title="怎么阅读"></a>怎么阅读</h3><p>布局显示</p>
<ul>
<li>相似的论文聚集在一起，并通过更强的线条（边缘）相连，<strong>线的颜色越深，联系越强</strong>，研究延续性越强。</li>
<li>指标刻画，<strong>论文被引越多，圆圈越大</strong>;论文越新，颜色越深。</li>
</ul>
<p><strong>List view</strong>：按时间顺序排列</p>
<p><strong>Prior and derivative works</strong></p>
<ul>
<li>开创性论文Prior </li>
<li>衍生的新方法论文&#x2F;综述derivative</li>
</ul>
<p><strong>右侧可以查看论文摘要并且创建新的CP图</strong></p>
<p><strong>下载</strong>：直接下载.bib结尾的引文格式</p>
<h2 id="Google"><a href="#Google" class="headerlink" title="Google"></a>Google</h2><blockquote>
<p><a href="https://www.google.com/">谷歌官网，需要梯子</a>，最后介绍一下搜索引擎的高级检索，百度也有类似的功能。</p>
<p><a href="http://www.googleguide.com/advanced_operators_reference.html">参考1-官方搜索运算符文档</a>，可以进行<u>标题，网址、文本、类型</u>等的检索。</p>
</blockquote>
<p>常用搜索（逻辑符(大写)：<strong>AND  OR</strong>，也可以用空格或+替换AND）</p>
<ul>
<li><strong>标题</strong>包含：intitle。如输入<u>intitle:google</u>（<strong>冒号后无空格</strong>），网页标题中带有google的网页都会被搜索出来。<ul>
<li>还有<strong>allintitle</strong>，可以进行多个关键词的检索，包括还有allintext, allinurl，用法类似。</li>
<li>也就是说进行单个&#x2F;并列关键词检索时二者检索结果均无区别，看习惯。**e.g., [ intitle:google intitle:search ] is the same as [ allintitle: google search ]**。</li>
</ul>
</li>
<li><strong>网址</strong>包含：inurl。搜索包含有特定字符的URL。</li>
<li><strong>网页正文</strong>包含：intext。搜索网页正文内容中的指定字符。</li>
<li><strong>文件</strong>检索：filetype。搜索指定类型的文件。例如输入<u>filetype:pdf</u>，将返回所有以pdf结尾的文件URL，这通常用于组合-即多条件检索,如 <u>inurl:google AND filetype:pdf</u>。<ul>
<li><img src="/posts/33f7b1b7/image-20220527104807053.png" class alt="searchfile"></li>
</ul>
</li>
<li><strong>相关网站</strong>检索site。找到与指定网站有联系的URL。例如输入<u>site:igsnrr.cas.cn</u>。所有和这个网站有联系的URL都会被显示。</li>
<li><strong>相似网站</strong>检索：related。查询将列出与您指定的网页相似的网页，如<u>related:igsnrr.cas.cn</u>：结果中会呈现科学网、中科院心理研究所、天文台等，可自行尝试。</li>
</ul>
]]></content>
      <categories>
        <category>科研</category>
      </categories>
      <tags>
        <tag>谷歌学术</tag>
      </tags>
  </entry>
  <entry>
    <title>订阅了Typora~</title>
    <url>/posts/34eb4d05/</url>
    <content><![CDATA[<p><a href="https://typora.io/">Topora</a>是一款简洁、优雅的markdown编辑器，加上首创的<strong>所见即所得</strong>风格，自定义主题等，我一直用来记笔记写文本，很推荐！</p>
<span id="more"></span>

<p>遗憾的是，今天下午发现typora旧的测试版已经无法打开，强制要求购买序列号。作为忠实粉的我最后尝试了一下一个翻版的开源软件<a href="https://github.com/marktext/marktext">MarkText</a>，也挺好用，能够实现一样的功能，体验上除了主题外观好像差别不大，在图片方面似乎做的更好，但我实在是习惯了Typora，所以选择了入手支持</p>
<ul>
<li>价格的话$15~￥89，支持三台设备，永久有效，可随时更换设备</li>
</ul>
<img src="/posts/34eb4d05/typora.png" class alt="激活成功">
]]></content>
      <categories>
        <category>Tools</category>
      </categories>
      <tags>
        <tag>Typora</tag>
      </tags>
  </entry>
</search>
